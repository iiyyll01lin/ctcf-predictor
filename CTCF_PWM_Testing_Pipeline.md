# CTCF PWM Testing Pipeline - Input & Output Files

## **INPUT FILES** (Required)

### Data Directory (`data/`)
- **`data/training_sequences.fasta`** ✅ (Primary input - CTCF training sequences; gen from: prepare_datasets.R)
- **`data/aligned_sequences.fasta`** (Generated by alignment analysis if missing; gen from: analyze_sequence_alignment.R)
- **`data/test_sequences.fasta`** (For validation; gen from: prepare_datasets.R)

### Data Flow Chain

```
Original Data Sources (from download_data.sh)
    ↓
data/preprocessed_sequences_optimized.fasta
    ↓
[prepare_datasets.R splits into:]
    ├── data/training_sequences.fasta (80%)
    └── data/test_sequences.fasta (20% + negatives)
    ↓
data/training_sequences.fasta
    ↓
[analyze_sequence_alignment.R processes:]
    ↓
data/aligned_sequences.fasta (aligned version)
```

### Scripts Directory (`scripts/`)
**Core Analysis Scripts:**
- [`scripts/analyze_sequence_quality.R`](scripts/analyze_sequence_quality.R)
- [`scripts/validate_pwm_quality.R`](scripts/validate_pwm_quality.R) 
- [`scripts/analyze_sequence_alignment.R`](scripts/analyze_sequence_alignment.R)

**PWM Building Scripts:**
- [`scripts/generate_null_models.R`](scripts/generate_null_models.R)
- [`scripts/simple_aligned_pwm.R`](scripts/simple_aligned_pwm.R)
- [`scripts/build_subset_pwm.R`](scripts/build_subset_pwm.R)
- [`scripts/efficient_aligned_pwm.R`](scripts/efficient_aligned_pwm.R)
- [`scripts/build_pwm_robust.R`](scripts/build_pwm_robust.R)
- [`scripts/advanced_alignment.R`](scripts/advanced_alignment.R)

**Analysis & Comparison Scripts:**
- [`scripts/compare_pwms.R`](scripts/compare_pwms.R)
- [`scripts/enhanced_compare_pwms.R`](scripts/enhanced_compare_pwms.R)
- [`scripts/statistical_significance_test.R`](scripts/statistical_significance_test.R)

## **OUTPUT FILES** (Generated)

### Results Directory (`results/`)

#### **Phase 1: Initial Analysis**
- `results/sequence_quality_analysis.txt`
- `results/pwm_quality_report.txt`
- `data/aligned_sequences.fasta` (if generated)

#### **Phase 2: Null Models**
- **`results/null_models/`** (Directory)
  - `results/null_models/null_summary_statistics.rds` ✅ (Key statistical baseline)
  - `results/null_models/*.fasta` (Multiple null sequence files)

#### **Phase 3: PWM Files**
- **`results/simple_aligned_pwm.rds`** ✅
- **`results/subset_pwm_size1000.rds`** ✅
- **`results/subset_pwm_size2000.rds`** ✅ 
- **`results/subset_pwm_size5000.rds`** ✅
- **`results/efficient_aligned_pwm.rds`** ✅
- `results/efficient_aligned_pwm_report.txt`
- **`results/advanced_consensus_basic.rds`** ✅
- **`results/advanced_length_basic.rds`** ✅
- `results/advanced_progressive_basic.rds` (if progressive alignment works)
- `results/robust_pwm*.rds` (from robust PWM building)

#### **Phase 4: Analysis Reports**
- **`results/pwm_comparison_report.html`** ✅ (Standard comparison)
- **`results/enhanced_pwm_comparison_report.html`** ✅ (With null model analysis)
- **`results/statistical_significance_report.html`** ✅ (Detailed statistical testing)
- `results/enhanced_pwm_comparison_report_data.rds` (Supporting data)

## **PIPELINE FLOW**

```
INPUT: training_sequences.fasta
    ↓
[Quality Analysis] → sequence_quality_analysis.txt
    ↓
[Alignment Analysis] → aligned_sequences.fasta
    ↓
[Null Model Generation] → null_models/ (100 replicates)
    ↓
[PWM Building] → Multiple .rds PWM files
    ↓
[Statistical Comparison] → HTML reports with significance testing
```

```
data/preprocessed_sequences_optimized.fasta (optimized preprocessing)
    ↓ [prepare_datasets.R splits into training/test]
data/training_sequences.fasta 
    ↓ [build_subset_pwm.R with 1000 high-quality sequences]
results/best_pwm.rds ✅ (Top-performing model)
```

## **KEY OUTPUT SUMMARY**

**Must-Have Results:**
1. **PWM Models**: ~8-10 `.rds` files with different PWM variants
2. **Statistical Baseline**: `null_models/null_summary_statistics.rds`
3. **Main Report**: `enhanced_pwm_comparison_report.html`
4. **Statistical Analysis**: `statistical_significance_report.html`

**Success Criteria:**
- Core PWM files: 10 expected files
- Null model statistics: Available for statistical testing
- Enhanced comparison report: Generated with null model analysis
- Statistical significance report: P-values and effect sizes

This pipeline creates a comprehensive PWM testing workflow with statistical validation against null models.